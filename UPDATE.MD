# Berkut Security Search v1.0.0 — Релиз браузерного расширения

Первый релиз **Berkut Security Search v1.0.0**, браузерного расширения для проверки поисковых запросов на соответствие базе данных запрещённых материалов. Этот релиз переводит проект с веб-приложения на базе Flask в расширение для браузера, обеспечивая лёгкое, полностью клиентское решение для соблюдения правил контента.

## Что нового

- **Архитектура браузерного расширения**:
  - Замена Flask-сервера на расширение, использующее HTML, CSS и JavaScript.
  - Использование WebAssembly SQLite (`sql-wasm.js`) для работы с базой данных в памяти, устраняющее необходимость в серверных зависимостях.
  - Полностью браузерное выполнение, повышающее портативность и снижающее задержки.
- **Сохранённые функции**:
  - Проверка запросов с использованием SQLite FTS5 для соответствия базе запрещённых материалов.
  - Управление избранными сайтами (плитками): добавление, редактирование, удаление, импорт и экспорт в формате JSON.
  - Информация о подключении с IP, страной, городом и интерактивной картой на Leaflet.js.
  - Настройка базы данных с поддержкой локальных файлов TXT или CSV.
  - Управление историей поиска с возможностью её очистки.
- **Современный интерфейс**:
  - Адаптивный дизайн с тёмной темой, вдохновлённый Tailwind CSS.
  - Единая цветовая схема: заголовок (`#e5e7eb`), сообщение о безопасном запросе (`#22c55e`), кнопки (`#4b5563`, hover: `#374151`).
  - Иконка лупы для favicon и иконки расширения (`icon16.png`, `icon32.png`, `icon48.png`, `icon128.png`).
- **Улучшения безопасности**:
  - Локальная обработка данных для обеспечения конфиденциальности.
  - Минимальные разрешения (`storage`, `activeTab`, `geolocation`) для снижения рисков.
  - Санитизация пользовательского ввода для защиты от XSS-атак.
- **Повышенная портативность**:
  - Использование относительных путей для файлов данных (`data/fs_em.csv`, `data/fs_em.txt`) и ресурсов.
  - Совместимость с браузерами на основе Chromium (Chrome, Edge) и Firefox.

## Установка

1. **Клонирование репозитория**:
   ```bash
   git clone https://github.com/berkutsolutions/berkut-security-search.git
   cd berkut-security-search
   ```

2. **Подготовка файлов данных**:
   - Поместите файлы `fs_em.csv` (формат: `№`, `Дата`, `Материал`) или `fs_em.txt` (разделитель: «Экстремистский материал №») в папку `data/`.

3. **Загрузка расширения**:
   - **Chrome/Edge**:
     1. Откройте `chrome://extensions/`.
     2. Включите **Режим разработчика**.
     3. Нажмите **Загрузить распакованное расширение** и выберите папку `berkut-security-search`.
   - **Firefox**:
     1. Откройте `about:debugging#/runtime/this-firefox`.
     2. Нажмите **Загрузить временное дополнение** и выберите `manifest.json`.

4. **Доступ к расширению**:
   - Нажмите на иконку расширения в панели инструментов браузера, чтобы открыть всплывающее окно.

## Использование

1. Откройте всплывающее окно расширения через иконку в панели инструментов.
2. **Управление плитками**:
   - Добавляйте сайты с помощью кнопки **Добавить сайт**.
   - Щёлкните правой кнопкой мыши по плитке для редактирования или удаления.
   - Импортируйте/экспортируйте плитки через кнопки **Импорт плиток** и **Экспорт плиток**.
3. **Поиск**:
   - Введите запрос и нажмите **Поиск**.
   - Безопасные запросы отображают сообщение «Запрос безопасен!» со ссылками на поисковые системы.
   - Запрещённые запросы показывают предупреждение с деталями в модальном окне.
4. **Настройки**:
   - Настройте источник базы данных (TXT или CSV) в модальном окне настроек.
   - Очистите историю поиска при необходимости.
5. **Информация о подключении**:
   - Просмотрите IP, страну, город и интерактивную карту в правой колонке.

## Примечания

- Убедитесь, что файлы `fs_em.csv` или `fs_em.txt` имеют правильный формат для инициализации базы данных.
- Расширение использует `sql-wasm.js` для SQLite в браузере, не требуя внешних зависимостей.
- Для загрузки тайлов карты Leaflet.js и работы API геолокации требуется интернет.
- Файл `manifest.json` включает минимальные разрешения для обеспечения безопасности.

## Лицензия
Распространяется под лицензией Mozilla Public License 2.0. Подробности: [https://mozilla.org/MPL/2.0/](https://mozilla.org/MPL/2.0/).

## Контакты
Для вопросов или обратной связи создайте issue на GitHub: [https://github.com/berkutsolutions/berkut-security-search](https://github.com/berkutsolutions/berkut-security-search).